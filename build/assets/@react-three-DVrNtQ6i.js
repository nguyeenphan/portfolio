import{r as g,j as V}from"./react-BHHcOLM9.js";import{L as Ce,T as Ie,R as Gt,U as Ut,B as Vt,M as qt,C as Xt,a as Yt,O as $e,P as Ne,S as Je,b as xe,N as Kt,A as Zt,W as Jt,c as Qt,d as en,e as tn,V as nn,f as Y,g as mt,h as rn,i as on,D as sn,j as he,k as Ge,l as an,m as Qe,H as cn,n as ln,F as un,o as fn,p as dn,q as pn,r as vn}from"./three-okop3vLy.js";import{c as et}from"./debounce-DO_VkvDk.js";import{F as mn,u as hn}from"./its-fine-DSxCNop1.js";import{R as gn,c as ae}from"./react-reconciler-CRfLAZkD.js";import{_ as _e}from"./@babel-Bv5sEHWb.js";import{c as yn}from"./react-dom-C3NjP5Fx.js";import{c as wn}from"./zustand-DvNOURWP.js";import"./maath-CkLz8BY2.js";import{G as Ue,D as bn,M as Me,O as En}from"./three-stdlib-CdpKd32l.js";import{s as ht,p as _n,c as Sn}from"./suspend-react-BKIKQNXN.js";import{Events as Pn}from"./hls.js-EjzhJXie.js";var Tr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Cn(e){let t;const r=new Set,i=(d,o)=>{const n=typeof d=="function"?d(t):d;if(n!==t){const s=t;t=o?n:Object.assign({},t,n),r.forEach(v=>v(t,s))}},c=()=>t,l=(d,o=c,n=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=o(t);function v(){const h=o(t);if(!n(s,h)){const w=s;d(s=h,w)}}return r.add(v),()=>r.delete(v)},u={setState:i,getState:c,subscribe:(d,o,n)=>o||n?l(d,o,n):(r.add(d),()=>r.delete(d)),destroy:()=>r.clear()};return t=e(i,c,u),u}const xn=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),tt=xn?g.useEffect:g.useLayoutEffect;function Mn(e){const t=typeof e=="function"?Cn(e):e,r=(i=t.getState,c=Object.is)=>{const[,l]=g.useReducer(p=>p+1,0),m=t.getState(),f=g.useRef(m),u=g.useRef(i),d=g.useRef(c),o=g.useRef(!1),n=g.useRef();n.current===void 0&&(n.current=i(m));let s,v=!1;(f.current!==m||u.current!==i||d.current!==c||o.current)&&(s=i(m),v=!c(n.current,s)),tt(()=>{v&&(n.current=s),f.current=m,u.current=i,d.current=c,o.current=!1});const h=g.useRef(m);tt(()=>{const p=()=>{try{const y=t.getState(),S=u.current(y);d.current(n.current,S)||(f.current=y,n.current=S,l())}catch{o.current=!0,l()}},a=t.subscribe(p);return t.getState()!==h.current&&p(),a},[]);const w=v?s:n.current;return g.useDebugValue(w),w};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[r,t];return{next(){const c=i.length<=0;return{value:i.shift(),done:c}}}},r}var gt={exports:{}},yt={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(b,M){var P=b.length;b.push(M);e:for(;0<P;){var O=P-1>>>1,D=b[O];if(0<c(D,M))b[O]=M,b[P]=D,P=O;else break e}}function r(b){return b.length===0?null:b[0]}function i(b){if(b.length===0)return null;var M=b[0],P=b.pop();if(P!==M){b[0]=P;e:for(var O=0,D=b.length,k=D>>>1;O<k;){var W=2*(O+1)-1,G=b[W],X=W+1,te=b[X];if(0>c(G,P))X<D&&0>c(te,G)?(b[O]=te,b[X]=P,O=X):(b[O]=G,b[W]=P,O=W);else if(X<D&&0>c(te,P))b[O]=te,b[X]=P,O=X;else break e}}return M}function c(b,M){var P=b.sortIndex-M.sortIndex;return P!==0?P:b.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var m=Date,f=m.now();e.unstable_now=function(){return m.now()-f}}var u=[],d=[],o=1,n=null,s=3,v=!1,h=!1,w=!1,p=typeof setTimeout=="function"?setTimeout:null,a=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(b){for(var M=r(d);M!==null;){if(M.callback===null)i(d);else if(M.startTime<=b)i(d),M.sortIndex=M.expirationTime,t(u,M);else break;M=r(d)}}function x(b){if(w=!1,S(b),!h)if(r(u)!==null)h=!0,N(C);else{var M=r(d);M!==null&&H(x,M.startTime-b)}}function C(b,M){h=!1,w&&(w=!1,a(j),j=-1),v=!0;var P=s;try{for(S(M),n=r(u);n!==null&&(!(n.expirationTime>M)||b&&!E());){var O=n.callback;if(typeof O=="function"){n.callback=null,s=n.priorityLevel;var D=O(n.expirationTime<=M);M=e.unstable_now(),typeof D=="function"?n.callback=D:n===r(u)&&i(u),S(M)}else i(u);n=r(u)}if(n!==null)var k=!0;else{var W=r(d);W!==null&&H(x,W.startTime-M),k=!1}return k}finally{n=null,s=P,v=!1}}var _=!1,T=null,j=-1,R=5,L=-1;function E(){return!(e.unstable_now()-L<R)}function A(){if(T!==null){var b=e.unstable_now();L=b;var M=!0;try{M=T(!0,b)}finally{M?B():(_=!1,T=null)}}else _=!1}var B;if(typeof y=="function")B=function(){y(A)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,I=q.port2;q.port1.onmessage=A,B=function(){I.postMessage(null)}}else B=function(){p(A,0)};function N(b){T=b,_||(_=!0,B())}function H(b,M){j=p(function(){b(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(b){b.callback=null},e.unstable_continueExecution=function(){h||v||(h=!0,N(C))},e.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<b?Math.floor(1e3/b):5},e.unstable_getCurrentPriorityLevel=function(){return s},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(b){switch(s){case 1:case 2:case 3:var M=3;break;default:M=s}var P=s;s=M;try{return b()}finally{s=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(b,M){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var P=s;s=b;try{return M()}finally{s=P}},e.unstable_scheduleCallback=function(b,M,P){var O=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?O+P:O):P=O,b){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=P+D,b={id:o++,callback:M,priorityLevel:b,startTime:P,expirationTime:D,sortIndex:-1},P>O?(b.sortIndex=P,t(d,b),r(u)===null&&b===r(d)&&(w?(a(j),j=-1):w=!0,H(x,P-O))):(b.sortIndex=D,t(u,b),h||v||(h=!0,N(C))),b},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(b){var M=s;return function(){var P=s;s=M;try{return b.apply(this,arguments)}finally{s=P}}}})(yt);gt.exports=yt;var nt=gt.exports;const Ve={},Rn=e=>void Object.assign(Ve,e);function On(e,t){function r(o,{args:n=[],attach:s,...v},h){let w=`${o[0].toUpperCase()}${o.slice(1)}`,p;if(o==="primitive"){if(v.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const a=v.object;p=ie(a,{type:o,root:h,attach:s,primitive:!0})}else{const a=Ve[w];if(!a)throw new Error(`R3F: ${w} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(n))throw new Error("R3F: The args prop must be an array!");p=ie(new a(...n),{type:o,root:h,attach:s,memoizedProps:{args:n}})}return p.__r3f.attach===void 0&&(p instanceof Vt?p.__r3f.attach="geometry":p instanceof qt&&(p.__r3f.attach="material")),w!=="inject"&&Te(p,v),p}function i(o,n){let s=!1;if(n){var v,h;(v=n.__r3f)!=null&&v.attach?Oe(o,n,n.__r3f.attach):n.isObject3D&&o.isObject3D&&(o.add(n),s=!0),s||(h=o.__r3f)==null||h.objects.push(n),n.__r3f||ie(n,{}),n.__r3f.parent=o,Be(n),se(n)}}function c(o,n,s){let v=!1;if(n){var h,w;if((h=n.__r3f)!=null&&h.attach)Oe(o,n,n.__r3f.attach);else if(n.isObject3D&&o.isObject3D){n.parent=o,n.dispatchEvent({type:"added"}),o.dispatchEvent({type:"childadded",child:n});const p=o.children.filter(y=>y!==n),a=p.indexOf(s);o.children=[...p.slice(0,a),n,...p.slice(a)],v=!0}v||(w=o.__r3f)==null||w.objects.push(n),n.__r3f||ie(n,{}),n.__r3f.parent=o,Be(n),se(n)}}function l(o,n,s=!1){o&&[...o].forEach(v=>m(n,v,s))}function m(o,n,s){if(n){var v,h,w;if(n.__r3f&&(n.__r3f.parent=null),(v=o.__r3f)!=null&&v.objects&&(o.__r3f.objects=o.__r3f.objects.filter(x=>x!==n)),(h=n.__r3f)!=null&&h.attach)at(o,n,n.__r3f.attach);else if(n.isObject3D&&o.isObject3D){var p;o.remove(n),(p=n.__r3f)!=null&&p.root&&In(be(n),n)}const y=(w=n.__r3f)==null?void 0:w.primitive,S=!y&&(s===void 0?n.dispose!==null:s);if(!y){var a;l((a=n.__r3f)==null?void 0:a.objects,n,S),l(n.children,n,S)}if(delete n.__r3f,S&&n.dispose&&n.type!=="Scene"){const x=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?nt.unstable_scheduleCallback(nt.unstable_IdlePriority,x):x()}se(o)}}function f(o,n,s,v){var h;const w=(h=o.__r3f)==null?void 0:h.parent;if(!w)return;const p=r(n,s,o.__r3f.root);if(o.children){for(const a of o.children)a.__r3f&&i(p,a);o.children=o.children.filter(a=>!a.__r3f)}o.__r3f.objects.forEach(a=>i(p,a)),o.__r3f.objects=[],o.__r3f.autoRemovedBeforeAppend||m(w,o),p.parent&&(p.__r3f.autoRemovedBeforeAppend=!0),i(w,p),p.raycast&&p.__r3f.eventCount&&be(p).getState().internal.interaction.push(p),[v,v.alternate].forEach(a=>{a!==null&&(a.stateNode=p,a.ref&&(typeof a.ref=="function"?a.ref(p):a.ref.current=p))})}const u=()=>{};return{reconciler:gn({createInstance:r,removeChild:m,appendChild:i,appendInitialChild:i,insertBefore:c,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(o,n)=>{if(!n)return;const s=o.getState().scene;s.__r3f&&(s.__r3f.root=o,i(s,n))},removeChildFromContainer:(o,n)=>{n&&m(o.getState().scene,n)},insertInContainerBefore:(o,n,s)=>{if(!n||!s)return;const v=o.getState().scene;v.__r3f&&c(v,n,s)},getRootHostContext:()=>null,getChildHostContext:o=>o,finalizeInitialChildren(o){var n;return!!((n=o==null?void 0:o.__r3f)!=null?n:{}).handlers},prepareUpdate(o,n,s,v){var h;if(((h=o==null?void 0:o.__r3f)!=null?h:{}).primitive&&v.object&&v.object!==o)return[!0];{const{args:p=[],children:a,...y}=v,{args:S=[],children:x,...C}=s;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((T,j)=>T!==S[j]))return[!0];const _=Ct(o,y,C,!0);return _.changes.length?[!1,_]:null}},commitUpdate(o,[n,s],v,h,w,p){n?f(o,v,w,p):Te(o,s)},commitMount(o,n,s,v){var h;const w=(h=o.__r3f)!=null?h:{};o.raycast&&w.handlers&&w.eventCount&&be(o).getState().internal.interaction.push(o)},getPublicInstance:o=>o,prepareForCommit:()=>null,preparePortalMount:o=>ie(o.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(o){var n;const{attach:s,parent:v}=(n=o.__r3f)!=null?n:{};s&&v&&at(v,o,s),o.isObject3D&&(o.visible=!1),se(o)},unhideInstance(o,n){var s;const{attach:v,parent:h}=(s=o.__r3f)!=null?s:{};v&&h&&Oe(h,o,v),(o.isObject3D&&n.visible==null||n.visible)&&(o.visible=!0),se(o)},createTextInstance:u,hideTextInstance:u,unhideTextInstance:u,getCurrentEventPriority:()=>t?t():ae.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&z.fun(performance.now)?performance.now:z.fun(Date.now)?Date.now:()=>0,scheduleTimeout:z.fun(setTimeout)?setTimeout:void 0,cancelTimeout:z.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Te}}var rt,ot;const Re=e=>"colorSpace"in e||"outputColorSpace"in e,wt=()=>{var e;return(e=Ve.ColorManagement)!=null?e:null},bt=e=>e&&e.isOrthographicCamera,Tn=e=>e&&e.hasOwnProperty("current"),pe=typeof window<"u"&&((rt=window.document)!=null&&rt.createElement||((ot=window.navigator)==null?void 0:ot.product)==="ReactNative")?g.useLayoutEffect:g.useEffect;function Et(e){const t=g.useRef(e);return pe(()=>void(t.current=e),[e]),t}function jn({set:e}){return pe(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class _t extends g.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}_t.getDerivedStateFromError=()=>({error:!0});const St="__default",it=new Map,Ln=e=>e&&!!e.memoized&&!!e.changes;function Pt(e){var t;const r=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}const ue=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()};function be(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const z={obj:e=>e===Object(e)&&!z.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:i="reference",strict:c=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(z.str(e)||z.num(e)||z.boo(e))return e===t;const l=z.obj(e);if(l&&i==="reference")return e===t;const m=z.arr(e);if(m&&r==="reference")return e===t;if((m||l)&&e===t)return!0;let f;for(f in e)if(!(f in t))return!1;if(l&&r==="shallow"&&i==="shallow"){for(f in c?t:e)if(!z.equ(e[f],t[f],{strict:c,objects:"reference"}))return!1}else for(f in c?t:e)if(e[f]!==t[f])return!1;if(z.und(f)){if(m&&e.length===0&&t.length===0||l&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function kn(e){const t={nodes:{},materials:{}};return e&&e.traverse(r=>{r.name&&(t.nodes[r.name]=r),r.material&&!t.materials[r.material.name]&&(t.materials[r.material.name]=r.material)}),t}function An(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ie(e,t){const r=e;return r.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function He(e,t){let r=e;if(t.includes("-")){const i=t.split("-"),c=i.pop();return r=i.reduce((l,m)=>l[m],e),{target:r,key:c}}else return{target:r,key:t}}const st=/-\d+$/;function Oe(e,t,r){if(z.str(r)){if(st.test(r)){const l=r.replace(st,""),{target:m,key:f}=He(e,l);Array.isArray(m[f])||(m[f]=[])}const{target:i,key:c}=He(e,r);t.__r3f.previousAttach=i[c],i[c]=t}else t.__r3f.previousAttach=r(e,t)}function at(e,t,r){var i,c;if(z.str(r)){const{target:l,key:m}=He(e,r),f=t.__r3f.previousAttach;f===void 0?delete l[m]:l[m]=f}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(c=t.__r3f)==null||delete c.previousAttach}function Ct(e,{children:t,key:r,ref:i,...c},{children:l,key:m,ref:f,...u}={},d=!1){const o=e.__r3f,n=Object.entries(c),s=[];if(d){const h=Object.keys(u);for(let w=0;w<h.length;w++)c.hasOwnProperty(h[w])||n.unshift([h[w],St+"remove"])}n.forEach(([h,w])=>{var p;if((p=e.__r3f)!=null&&p.primitive&&h==="object"||z.equ(w,u[h]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(h))return s.push([h,w,!0,[]]);let a=[];h.includes("-")&&(a=h.split("-")),s.push([h,w,!1,a]);for(const y in c){const S=c[y];y.startsWith(`${h}-`)&&s.push([y,S,!1,y.split("-")])}});const v={...c};return o!=null&&o.memoizedProps&&o!=null&&o.memoizedProps.args&&(v.args=o.memoizedProps.args),o!=null&&o.memoizedProps&&o!=null&&o.memoizedProps.attach&&(v.attach=o.memoizedProps.attach),{memoized:v,changes:s}}const Dn=typeof process<"u"&&!1;function Te(e,t){var r;const i=e.__r3f,c=i==null?void 0:i.root,l=c==null||c.getState==null?void 0:c.getState(),{memoized:m,changes:f}=Ln(t)?t:Ct(e,t),u=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=m);for(let o=0;o<f.length;o++){let[n,s,v,h]=f[o];if(Re(e)){const y="srgb",S="srgb-linear";n==="encoding"?(n="colorSpace",s=s===3001?y:S):n==="outputEncoding"&&(n="outputColorSpace",s=s===3001?y:S)}let w=e,p=w[n];if(h.length&&(p=h.reduce((a,y)=>a[y],e),!(p&&p.set))){const[a,...y]=h.reverse();w=y.reverse().reduce((S,x)=>S[x],e),n=a}if(s===St+"remove")if(w.constructor){let a=it.get(w.constructor);a||(a=new w.constructor,it.set(w.constructor,a)),s=a[n]}else s=0;if(v&&i)s?i.handlers[n]=s:delete i.handlers[n],i.eventCount=Object.keys(i.handlers).length;else if(p&&p.set&&(p.copy||p instanceof Ce)){if(Array.isArray(s))p.fromArray?p.fromArray(s):p.set(...s);else if(p.copy&&s&&s.constructor&&(Dn?p.constructor.name===s.constructor.name:p.constructor===s.constructor))p.copy(s);else if(s!==void 0){const a=p instanceof Xt;!a&&p.setScalar?p.setScalar(s):p instanceof Ce&&s instanceof Ce?p.mask=s.mask:p.set(s),!wt()&&l&&!l.linear&&a&&p.convertSRGBToLinear()}}else if(w[n]=s,w[n]instanceof Ie&&w[n].format===Gt&&w[n].type===Ut&&l){const a=w[n];Re(a)&&Re(l.gl)?a.colorSpace=l.gl.outputColorSpace:a.encoding=l.gl.outputEncoding}se(e)}if(i&&i.parent&&e.raycast&&u!==i.eventCount){const o=be(e).getState().internal,n=o.interaction.indexOf(e);n>-1&&o.interaction.splice(n,1),i.eventCount&&o.interaction.push(e)}return!(f.length===1&&f[0][0]==="onUpdate")&&f.length&&(r=e.__r3f)!=null&&r.parent&&Be(e),e}function se(e){var t,r;const i=(t=e.__r3f)==null||(r=t.root)==null||r.getState==null?void 0:r.getState();i&&i.internal.frames===0&&i.invalidate()}function Be(e){e.onUpdate==null||e.onUpdate(e)}function zn(e,t){e.manual||(bt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ge(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Fn(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return ae.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ae.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ae.ContinuousEventPriority;default:return ae.DefaultEventPriority}}function xt(e,t,r,i){const c=r.get(t);c&&(r.delete(t),r.size===0&&(e.delete(i),c.target.releasePointerCapture(i)))}function In(e,t){const{internal:r}=e.getState();r.interaction=r.interaction.filter(i=>i!==t),r.initialHits=r.initialHits.filter(i=>i!==t),r.hovered.forEach((i,c)=>{(i.eventObject===t||i.object===t)&&r.hovered.delete(c)}),r.capturedMap.forEach((i,c)=>{xt(r.capturedMap,t,i,c)})}function Hn(e){function t(u){const{internal:d}=e.getState(),o=u.offsetX-d.initialClick[0],n=u.offsetY-d.initialClick[1];return Math.round(Math.sqrt(o*o+n*n))}function r(u){return u.filter(d=>["Move","Over","Enter","Out","Leave"].some(o=>{var n;return(n=d.__r3f)==null?void 0:n.handlers["onPointer"+o]}))}function i(u,d){const o=e.getState(),n=new Set,s=[],v=d?d(o.internal.interaction):o.internal.interaction;for(let a=0;a<v.length;a++){const y=ue(v[a]);y&&(y.raycaster.camera=void 0)}o.previousRoot||o.events.compute==null||o.events.compute(u,o);function h(a){const y=ue(a);if(!y||!y.events.enabled||y.raycaster.camera===null)return[];if(y.raycaster.camera===void 0){var S;y.events.compute==null||y.events.compute(u,y,(S=y.previousRoot)==null?void 0:S.getState()),y.raycaster.camera===void 0&&(y.raycaster.camera=null)}return y.raycaster.camera?y.raycaster.intersectObject(a,!0):[]}let w=v.flatMap(h).sort((a,y)=>{const S=ue(a.object),x=ue(y.object);return!S||!x?a.distance-y.distance:x.events.priority-S.events.priority||a.distance-y.distance}).filter(a=>{const y=ge(a);return n.has(y)?!1:(n.add(y),!0)});o.events.filter&&(w=o.events.filter(w,o));for(const a of w){let y=a.object;for(;y;){var p;(p=y.__r3f)!=null&&p.eventCount&&s.push({...a,eventObject:y}),y=y.parent}}if("pointerId"in u&&o.internal.capturedMap.has(u.pointerId))for(let a of o.internal.capturedMap.get(u.pointerId).values())n.has(ge(a.intersection))||s.push(a.intersection);return s}function c(u,d,o,n){const s=e.getState();if(u.length){const v={stopped:!1};for(const h of u){const w=ue(h.object)||s,{raycaster:p,pointer:a,camera:y,internal:S}=w,x=new Y(a.x,a.y,0).unproject(y),C=L=>{var E,A;return(E=(A=S.capturedMap.get(L))==null?void 0:A.has(h.eventObject))!=null?E:!1},_=L=>{const E={intersection:h,target:d.target};S.capturedMap.has(L)?S.capturedMap.get(L).set(h.eventObject,E):S.capturedMap.set(L,new Map([[h.eventObject,E]])),d.target.setPointerCapture(L)},T=L=>{const E=S.capturedMap.get(L);E&&xt(S.capturedMap,h.eventObject,E,L)};let j={};for(let L in d){let E=d[L];typeof E!="function"&&(j[L]=E)}let R={...h,...j,pointer:a,intersections:u,stopped:v.stopped,delta:o,unprojectedPoint:x,ray:p.ray,camera:y,stopPropagation(){const L="pointerId"in d&&S.capturedMap.get(d.pointerId);if((!L||L.has(h.eventObject))&&(R.stopped=v.stopped=!0,S.hovered.size&&Array.from(S.hovered.values()).find(E=>E.eventObject===h.eventObject))){const E=u.slice(0,u.indexOf(h));l([...E,h])}},target:{hasPointerCapture:C,setPointerCapture:_,releasePointerCapture:T},currentTarget:{hasPointerCapture:C,setPointerCapture:_,releasePointerCapture:T},nativeEvent:d};if(n(R),v.stopped===!0)break}}return u}function l(u){const{internal:d}=e.getState();for(const o of d.hovered.values())if(!u.length||!u.find(n=>n.object===o.object&&n.index===o.index&&n.instanceId===o.instanceId)){const s=o.eventObject.__r3f,v=s==null?void 0:s.handlers;if(d.hovered.delete(ge(o)),s!=null&&s.eventCount){const h={...o,intersections:u};v.onPointerOut==null||v.onPointerOut(h),v.onPointerLeave==null||v.onPointerLeave(h)}}}function m(u,d){for(let o=0;o<d.length;o++){const n=d[o].__r3f;n==null||n.handlers.onPointerMissed==null||n.handlers.onPointerMissed(u)}}function f(u){switch(u){case"onPointerLeave":case"onPointerCancel":return()=>l([]);case"onLostPointerCapture":return d=>{const{internal:o}=e.getState();"pointerId"in d&&o.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{o.capturedMap.has(d.pointerId)&&(o.capturedMap.delete(d.pointerId),l([]))})}}return function(o){const{onPointerMissed:n,internal:s}=e.getState();s.lastEvent.current=o;const v=u==="onPointerMove",h=u==="onClick"||u==="onContextMenu"||u==="onDoubleClick",p=i(o,v?r:void 0),a=h?t(o):0;u==="onPointerDown"&&(s.initialClick=[o.offsetX,o.offsetY],s.initialHits=p.map(S=>S.eventObject)),h&&!p.length&&a<=2&&(m(o,s.interaction),n&&n(o)),v&&l(p);function y(S){const x=S.eventObject,C=x.__r3f,_=C==null?void 0:C.handlers;if(C!=null&&C.eventCount)if(v){if(_.onPointerOver||_.onPointerEnter||_.onPointerOut||_.onPointerLeave){const T=ge(S),j=s.hovered.get(T);j?j.stopped&&S.stopPropagation():(s.hovered.set(T,S),_.onPointerOver==null||_.onPointerOver(S),_.onPointerEnter==null||_.onPointerEnter(S))}_.onPointerMove==null||_.onPointerMove(S)}else{const T=_[u];T?(!h||s.initialHits.includes(x))&&(m(o,s.interaction.filter(j=>!s.initialHits.includes(j))),T(S)):h&&s.initialHits.includes(x)&&m(o,s.interaction.filter(j=>!s.initialHits.includes(j)))}}c(p,o,a,y)}}return{handlePointer:f}}const Mt=e=>!!(e!=null&&e.render),Rt=g.createContext(null),Bn=(e,t)=>{const r=Mn((f,u)=>{const d=new Y,o=new Y,n=new Y;function s(a=u().camera,y=o,S=u().size){const{width:x,height:C,top:_,left:T}=S,j=x/C;y instanceof Y?n.copy(y):n.set(...y);const R=a.getWorldPosition(d).distanceTo(n);if(bt(a))return{width:x/a.zoom,height:C/a.zoom,top:_,left:T,factor:1,distance:R,aspect:j};{const L=a.fov*Math.PI/180,E=2*Math.tan(L/2)*R,A=E*(x/C);return{width:A,height:E,top:_,left:T,factor:x/A,distance:R,aspect:j}}}let v;const h=a=>f(y=>({performance:{...y.performance,current:a}})),w=new mt;return{set:f,get:u,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(a=1)=>e(u(),a),advance:(a,y)=>t(a,y,u()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new rn,pointer:w,mouse:w,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const a=u();v&&clearTimeout(v),a.performance.current!==a.performance.min&&h(a.performance.min),v=setTimeout(()=>h(u().performance.max),a.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},setEvents:a=>f(y=>({...y,events:{...y.events,...a}})),setSize:(a,y,S,x,C)=>{const _=u().camera,T={width:a,height:y,top:x||0,left:C||0,updateStyle:S};f(j=>({size:T,viewport:{...j.viewport,...s(_,o,T)}}))},setDpr:a=>f(y=>{const S=Pt(a);return{viewport:{...y.viewport,dpr:S,initialDpr:y.viewport.initialDpr||S}}}),setFrameloop:(a="always")=>{const y=u().clock;y.stop(),y.elapsedTime=0,a!=="never"&&(y.start(),y.elapsedTime=0),f(()=>({frameloop:a}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:g.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(a,y,S)=>{const x=u().internal;return x.priority=x.priority+(y>0?1:0),x.subscribers.push({ref:a,priority:y,store:S}),x.subscribers=x.subscribers.sort((C,_)=>C.priority-_.priority),()=>{const C=u().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(y>0?1:0),C.subscribers=C.subscribers.filter(_=>_.ref!==a))}}}}}),i=r.getState();let c=i.size,l=i.viewport.dpr,m=i.camera;return r.subscribe(()=>{const{camera:f,size:u,viewport:d,gl:o,set:n}=r.getState();if(u.width!==c.width||u.height!==c.height||d.dpr!==l){var s;c=u,l=d.dpr,zn(f,u),o.setPixelRatio(d.dpr);const v=(s=u.updateStyle)!=null?s:typeof HTMLCanvasElement<"u"&&o.domElement instanceof HTMLCanvasElement;o.setSize(u.width,u.height,v)}f!==m&&(m=f,n(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(f)}})))}),r.subscribe(f=>e(f)),r};let ye,Wn=new Set,$n=new Set,Nn=new Set;function je(e,t){if(e.size)for(const{callback:r}of e.values())r(t)}function fe(e,t){switch(e){case"before":return je(Wn,t);case"after":return je($n,t);case"tail":return je(Nn,t)}}let Le,ke;function Ae(e,t,r){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Le=t.internal.subscribers,ye=0;ye<Le.length;ye++)ke=Le[ye],ke.ref.current(ke.store.getState(),i,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function Gn(e){let t=!1,r=!1,i,c,l;function m(d){c=requestAnimationFrame(m),t=!0,i=0,fe("before",d),r=!0;for(const n of e.values()){var o;l=n.store.getState(),l.internal.active&&(l.frameloop==="always"||l.internal.frames>0)&&!((o=l.gl.xr)!=null&&o.isPresenting)&&(i+=Ae(d,l))}if(r=!1,fe("after",d),i===0)return fe("tail",d),t=!1,cancelAnimationFrame(c)}function f(d,o=1){var n;if(!d)return e.forEach(s=>f(s.store.getState(),o));(n=d.gl.xr)!=null&&n.isPresenting||!d.internal.active||d.frameloop==="never"||(o>1?d.internal.frames=Math.min(60,d.internal.frames+o):r?d.internal.frames=2:d.internal.frames=1,t||(t=!0,requestAnimationFrame(m)))}function u(d,o=!0,n,s){if(o&&fe("before",d),n)Ae(d,n,s);else for(const v of e.values())Ae(d,v.store.getState());o&&fe("after",d)}return{loop:m,invalidate:f,advance:u}}function Ot(){const e=g.useContext(Rt);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function $(e=r=>r,t){return Ot()(e,t)}function Se(e,t=0){const r=Ot(),i=r.getState().internal.subscribe,c=Et(e);return pe(()=>i(c,t,r),[t,i,r]),null}const ct=new WeakMap;function Tt(e,t){return function(r,...i){let c=ct.get(r);return c||(c=new r,ct.set(r,c)),e&&e(c),Promise.all(i.map(l=>new Promise((m,f)=>c.load(l,u=>{u.scene&&Object.assign(u,kn(u.scene)),m(u)},t,u=>f(new Error(`Could not load ${l}: ${u==null?void 0:u.message}`))))))}}function Z(e,t,r,i){const c=Array.isArray(t)?t:[t],l=ht(Tt(r,i),[e,...c],{equal:z.equ});return Array.isArray(t)?l:l[0]}Z.preload=function(e,t,r){const i=Array.isArray(t)?t:[t];return _n(Tt(r),[e,...i])};Z.clear=function(e,t){const r=Array.isArray(t)?t:[t];return Sn([e,...r])};const ce=new Map,{invalidate:lt,advance:ut}=Gn(ce),{reconciler:Ee,applyProps:re}=On(ce,Fn),oe={objects:"shallow",strict:!1},Un=(e,t)=>{const r=typeof e=="function"?e(t):e;return Mt(r)?r:new Jt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function Vn(e,t){const r=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(t){const{width:i,height:c,top:l,left:m,updateStyle:f=r}=t;return{width:i,height:c,top:l,left:m,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:c,top:l,left:m}=e.parentElement.getBoundingClientRect();return{width:i,height:c,top:l,left:m,updateStyle:r}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:r};return{width:0,height:0,top:0,left:0}}function qn(e){const t=ce.get(e),r=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const c=typeof reportError=="function"?reportError:console.error,l=i||Bn(lt,ut),m=r||Ee.createContainer(l,ae.ConcurrentRoot,null,!1,null,"",c,null);t||ce.set(e,{fiber:m,store:l});let f,u=!1,d;return{configure(o={}){let{gl:n,size:s,scene:v,events:h,onCreated:w,shadows:p=!1,linear:a=!1,flat:y=!1,legacy:S=!1,orthographic:x=!1,frameloop:C="always",dpr:_=[1,2],performance:T,raycaster:j,camera:R,onPointerMissed:L}=o,E=l.getState(),A=E.gl;E.gl||E.set({gl:A=Un(n,e)});let B=E.raycaster;B||E.set({raycaster:B=new Yt});const{params:q,...I}=j||{};if(z.equ(I,B,oe)||re(B,{...I}),z.equ(q,B.params,oe)||re(B,{params:{...B.params,...q}}),!E.camera||E.camera===d&&!z.equ(d,R,oe)){d=R;const P=R instanceof Qt,O=P?R:x?new $e(0,0,0,0,.1,1e3):new Ne(75,0,.1,1e3);P||(O.position.z=5,R&&(re(O,R),("aspect"in R||"left"in R||"right"in R||"bottom"in R||"top"in R)&&(O.manual=!0,O.updateProjectionMatrix())),!E.camera&&!(R!=null&&R.rotation)&&O.lookAt(0,0,0)),E.set({camera:O}),B.camera=O}if(!E.scene){let P;v instanceof Je?P=v:(P=new Je,v&&re(P,v)),E.set({scene:ie(P)})}if(!E.xr){var N;const P=(k,W)=>{const G=l.getState();G.frameloop!=="never"&&ut(k,!0,G,W)},O=()=>{const k=l.getState();k.gl.xr.enabled=k.gl.xr.isPresenting,k.gl.xr.setAnimationLoop(k.gl.xr.isPresenting?P:null),k.gl.xr.isPresenting||lt(k)},D={connect(){const k=l.getState().gl;k.xr.addEventListener("sessionstart",O),k.xr.addEventListener("sessionend",O)},disconnect(){const k=l.getState().gl;k.xr.removeEventListener("sessionstart",O),k.xr.removeEventListener("sessionend",O)}};typeof((N=A.xr)==null?void 0:N.addEventListener)=="function"&&D.connect(),E.set({xr:D})}if(A.shadowMap){const P=A.shadowMap.enabled,O=A.shadowMap.type;if(A.shadowMap.enabled=!!p,z.boo(p))A.shadowMap.type=xe;else if(z.str(p)){var H;const D={basic:en,percentage:tn,soft:xe,variance:nn};A.shadowMap.type=(H=D[p])!=null?H:xe}else z.obj(p)&&Object.assign(A.shadowMap,p);(P!==A.shadowMap.enabled||O!==A.shadowMap.type)&&(A.shadowMap.needsUpdate=!0)}const b=wt();b&&("enabled"in b?b.enabled=!S:"legacyMode"in b&&(b.legacyMode=S)),u||re(A,{outputEncoding:a?3e3:3001,toneMapping:y?Kt:Zt}),E.legacy!==S&&E.set(()=>({legacy:S})),E.linear!==a&&E.set(()=>({linear:a})),E.flat!==y&&E.set(()=>({flat:y})),n&&!z.fun(n)&&!Mt(n)&&!z.equ(n,A,oe)&&re(A,n),h&&!E.events.handlers&&E.set({events:h(l)});const M=Vn(e,s);return z.equ(M,E.size,oe)||E.setSize(M.width,M.height,M.updateStyle,M.top,M.left),_&&E.viewport.dpr!==Pt(_)&&E.setDpr(_),E.frameloop!==C&&E.setFrameloop(C),E.onPointerMissed||E.set({onPointerMissed:L}),T&&!z.equ(T,E.performance,oe)&&E.set(P=>({performance:{...P.performance,...T}})),f=w,u=!0,this},render(o){return u||this.configure(),Ee.updateContainer(V.jsx(Xn,{store:l,children:o,onCreated:f,rootElement:e}),m,null,()=>{}),l},unmount(){jt(e)}}}function Xn({store:e,children:t,onCreated:r,rootElement:i}){return pe(()=>{const c=e.getState();c.set(l=>({internal:{...l.internal,active:!0}})),r&&r(c),e.getState().events.connected||c.events.connect==null||c.events.connect(i)},[]),V.jsx(Rt.Provider,{value:e,children:t})}function jt(e,t){const r=ce.get(e),i=r==null?void 0:r.fiber;if(i){const c=r==null?void 0:r.store.getState();c&&(c.internal.active=!1),Ee.updateContainer(null,i,null,()=>{c&&setTimeout(()=>{try{var l,m,f,u;c.events.disconnect==null||c.events.disconnect(),(l=c.gl)==null||(m=l.renderLists)==null||m.dispose==null||m.dispose(),(f=c.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(u=c.gl)!=null&&u.xr&&c.xr.disconnect(),An(c),ce.delete(e)}catch{}},500)})}}Ee.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:g.version});const De={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Yn(e){const{handlePointer:t}=Hn(e);return{priority:1,enabled:!0,compute(r,i,c){i.pointer.set(r.offsetX/i.size.width*2-1,-(r.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(De).reduce((r,i)=>({...r,[i]:t(i)}),{}),update:()=>{var r;const{events:i,internal:c}=e.getState();(r=c.lastEvent)!=null&&r.current&&i.handlers&&i.handlers.onPointerMove(c.lastEvent.current)},connect:r=>{var i;const{set:c,events:l}=e.getState();l.disconnect==null||l.disconnect(),c(m=>({events:{...m.events,connected:r}})),Object.entries((i=l.handlers)!=null?i:[]).forEach(([m,f])=>{const[u,d]=De[m];r.addEventListener(u,f,{passive:d})})},disconnect:()=>{const{set:r,events:i}=e.getState();if(i.connected){var c;Object.entries((c=i.handlers)!=null?c:[]).forEach(([l,m])=>{if(i&&i.connected instanceof HTMLElement){const[f]=De[l];i.connected.removeEventListener(f,m)}}),r(l=>({events:{...l.events,connected:void 0}}))}}}}function Kn({debounce:e,scroll:t,polyfill:r,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const c=r||typeof window<"u"&&window.ResizeObserver,[l,m]=g.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0});if(!c)return l.width=1280,l.height=800,[()=>{},l,()=>{}];const f=g.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l,orientationHandler:null}),u=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,o=g.useRef(!1);g.useEffect(()=>(o.current=!0,()=>void(o.current=!1)));const[n,s,v]=g.useMemo(()=>{const a=()=>{if(!f.current.element)return;const{left:y,top:S,width:x,height:C,bottom:_,right:T,x:j,y:R}=f.current.element.getBoundingClientRect(),L={left:y,top:S,width:x,height:C,bottom:_,right:T,x:j,y:R};f.current.element instanceof HTMLElement&&i&&(L.height=f.current.element.offsetHeight,L.width=f.current.element.offsetWidth),Object.freeze(L),o.current&&!er(f.current.lastBounds,L)&&m(f.current.lastBounds=L)};return[a,d?et(a,d):a,u?et(a,u):a]},[m,i,u,d]);function h(){f.current.scrollContainers&&(f.current.scrollContainers.forEach(a=>a.removeEventListener("scroll",v,!0)),f.current.scrollContainers=null),f.current.resizeObserver&&(f.current.resizeObserver.disconnect(),f.current.resizeObserver=null),f.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",f.current.orientationHandler))}function w(){var a;f.current.element&&(f.current.resizeObserver=new c(s),(a=f.current.resizeObserver)==null||a.observe(f.current.element),t&&f.current.scrollContainers&&f.current.scrollContainers.forEach(y=>y.addEventListener("scroll",v,{capture:!0,passive:!0})),f.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",f.current.orientationHandler))}const p=a=>{!a||a===f.current.element||(h(),f.current.element=a,f.current.scrollContainers=Lt(a),w())};return Jn(v,!!t),Zn(s),g.useEffect(()=>{h(),w()},[t,v,s]),g.useEffect(()=>h,[]),[p,l,n]}function Zn(e){g.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function Jn(e,t){g.useEffect(()=>{if(t){const r=e;return window.addEventListener("scroll",r,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",r,!0)}},[e,t])}function Lt(e){const t=[];if(!e||e===document.body)return t;const{overflow:r,overflowX:i,overflowY:c}=window.getComputedStyle(e);return[r,i,c].some(l=>l==="auto"||l==="scroll")&&t.push(e),[...t,...Lt(e.parentElement)]}const Qn=["x","y","top","bottom","left","right","width","height"],er=(e,t)=>Qn.every(r=>e[r]===t[r]),tr=g.forwardRef(function({children:t,fallback:r,resize:i,style:c,gl:l,events:m=Yn,eventSource:f,eventPrefix:u,shadows:d,linear:o,flat:n,legacy:s,orthographic:v,frameloop:h,dpr:w,performance:p,raycaster:a,camera:y,scene:S,onPointerMissed:x,onCreated:C,..._},T){g.useMemo(()=>Rn(on),[]);const j=hn(),[R,L]=Kn({scroll:!0,debounce:{scroll:50,resize:0},...i}),E=g.useRef(null),A=g.useRef(null);g.useImperativeHandle(T,()=>E.current);const B=Et(x),[q,I]=g.useState(!1),[N,H]=g.useState(!1);if(q)throw q;if(N)throw N;const b=g.useRef(null);pe(()=>{const P=E.current;L.width>0&&L.height>0&&P&&(b.current||(b.current=qn(P)),b.current.configure({gl:l,events:m,shadows:d,linear:o,flat:n,legacy:s,orthographic:v,frameloop:h,dpr:w,performance:p,raycaster:a,camera:y,scene:S,size:L,onPointerMissed:(...O)=>B.current==null?void 0:B.current(...O),onCreated:O=>{O.events.connect==null||O.events.connect(f?Tn(f)?f.current:f:A.current),u&&O.setEvents({compute:(D,k)=>{const W=D[u+"X"],G=D[u+"Y"];k.pointer.set(W/k.size.width*2-1,-(G/k.size.height)*2+1),k.raycaster.setFromCamera(k.pointer,k.camera)}}),C==null||C(O)}}),b.current.render(V.jsx(j,{children:V.jsx(_t,{set:H,children:V.jsx(g.Suspense,{fallback:V.jsx(jn,{set:I}),children:t})})})))}),g.useEffect(()=>{const P=E.current;if(P)return()=>jt(P)},[]);const M=f?"none":"auto";return V.jsx("div",{ref:A,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:M,...c},..._,children:V.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:V.jsx("canvas",{ref:E,style:{display:"block"},children:r})})})}),Lr=g.forwardRef(function(t,r){return V.jsx(mn,{children:V.jsx(tr,{...t,ref:r})})}),ve=new Y,qe=new Y,nr=new Y,ft=new mt;function rr(e,t,r){const i=ve.setFromMatrixPosition(e.matrixWorld);i.project(t);const c=r.width/2,l=r.height/2;return[i.x*c+c,-(i.y*l)+l]}function or(e,t){const r=ve.setFromMatrixPosition(e.matrixWorld),i=qe.setFromMatrixPosition(t.matrixWorld),c=r.sub(i),l=t.getWorldDirection(nr);return c.angleTo(l)>Math.PI/2}function ir(e,t,r,i){const c=ve.setFromMatrixPosition(e.matrixWorld),l=c.clone();l.project(t),ft.set(l.x,l.y),r.setFromCamera(ft,t);const m=r.intersectObjects(i,!0);if(m.length){const f=m[0].distance;return c.distanceTo(r.ray.origin)<f}return!0}function sr(e,t){if(t instanceof $e)return t.zoom;if(t instanceof Ne){const r=ve.setFromMatrixPosition(e.matrixWorld),i=qe.setFromMatrixPosition(t.matrixWorld),c=t.fov*Math.PI/180,l=r.distanceTo(i);return 1/(2*Math.tan(c/2)*l)}else return 1}function ar(e,t,r){if(t instanceof Ne||t instanceof $e){const i=ve.setFromMatrixPosition(e.matrixWorld),c=qe.setFromMatrixPosition(t.matrixWorld),l=i.distanceTo(c),m=(r[1]-r[0])/(t.far-t.near),f=r[1]-m*t.far;return Math.round(m*l+f)}}const We=e=>Math.abs(e)<1e-10?0:e;function kt(e,t,r=""){let i="matrix3d(";for(let c=0;c!==16;c++)i+=We(t[c]*e.elements[c])+(c!==15?",":")");return r+i}const cr=(e=>t=>kt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),lr=(e=>(t,r)=>kt(t,e(r),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function ur(e){return e&&typeof e=="object"&&"current"in e}const kr=g.forwardRef(({children:e,eps:t=.001,style:r,className:i,prepend:c,center:l,fullscreen:m,portal:f,distanceFactor:u,sprite:d=!1,transform:o=!1,occlude:n,onOcclude:s,castShadow:v,receiveShadow:h,material:w,geometry:p,zIndexRange:a=[16777271,0],calculatePosition:y=rr,as:S="div",wrapperClass:x,pointerEvents:C="auto",..._},T)=>{const{gl:j,camera:R,scene:L,size:E,raycaster:A,events:B,viewport:q}=$(),[I]=g.useState(()=>document.createElement(S)),N=g.useRef(),H=g.useRef(null),b=g.useRef(0),M=g.useRef([0,0]),P=g.useRef(null),O=g.useRef(null),D=(f==null?void 0:f.current)||B.connected||j.domElement.parentNode,k=g.useRef(null),W=g.useRef(!1),G=g.useMemo(()=>n&&n!=="blending"||Array.isArray(n)&&n.length&&ur(n[0]),[n]);g.useLayoutEffect(()=>{const U=j.domElement;n&&n==="blending"?(U.style.zIndex=`${Math.floor(a[0]/2)}`,U.style.position="absolute",U.style.pointerEvents="none"):(U.style.zIndex=null,U.style.position=null,U.style.pointerEvents=null)},[n]),g.useLayoutEffect(()=>{if(H.current){const U=N.current=yn(I);if(L.updateMatrixWorld(),o)I.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const F=y(H.current,R,E);I.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${F[0]}px,${F[1]}px,0);transform-origin:0 0;`}return D&&(c?D.prepend(I):D.appendChild(I)),()=>{D&&D.removeChild(I),U.unmount()}}},[D,o]),g.useLayoutEffect(()=>{x&&(I.className=x)},[x]);const X=g.useMemo(()=>o?{position:"absolute",top:0,left:0,width:E.width,height:E.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:l?"translate3d(-50%,-50%,0)":"none",...m&&{top:-E.height/2,left:-E.width/2,width:E.width,height:E.height},...r},[r,l,m,E,o]),te=g.useMemo(()=>({position:"absolute",pointerEvents:C}),[C]);g.useLayoutEffect(()=>{if(W.current=!1,o){var U;(U=N.current)==null||U.render(g.createElement("div",{ref:P,style:X},g.createElement("div",{ref:O,style:te},g.createElement("div",{ref:T,className:i,style:r,children:e}))))}else{var F;(F=N.current)==null||F.render(g.createElement("div",{ref:T,style:X,className:i,children:e}))}});const ne=g.useRef(!0);Se(U=>{if(H.current){R.updateMatrixWorld(),H.current.updateWorldMatrix(!0,!1);const F=o?M.current:y(H.current,R,E);if(o||Math.abs(b.current-R.zoom)>t||Math.abs(M.current[0]-F[0])>t||Math.abs(M.current[1]-F[1])>t){const J=or(H.current,R);let K=!1;G&&(Array.isArray(n)?K=n.map(Q=>Q.current):n!=="blending"&&(K=[L]));const le=ne.current;if(K){const Q=ir(H.current,R,A,K);ne.current=Q&&!J}else ne.current=!J;le!==ne.current&&(s?s(!ne.current):I.style.display=ne.current?"block":"none");const me=Math.floor(a[0]/2),Ft=n?G?[a[0],me]:[me-1,0]:a;if(I.style.zIndex=`${ar(H.current,R,Ft)}`,o){const[Q,Ke]=[E.width/2,E.height/2],Pe=R.projectionMatrix.elements[5]*Ke,{isOrthographicCamera:Ze,top:It,left:Ht,bottom:Bt,right:Wt}=R,$t=cr(R.matrixWorldInverse),Nt=Ze?`scale(${Pe})translate(${We(-(Wt+Ht)/2)}px,${We((It+Bt)/2)}px)`:`translateZ(${Pe}px)`;let ee=H.current.matrixWorld;d&&(ee=R.matrixWorldInverse.clone().transpose().copyPosition(ee).scale(H.current.scale),ee.elements[3]=ee.elements[7]=ee.elements[11]=0,ee.elements[15]=1),I.style.width=E.width+"px",I.style.height=E.height+"px",I.style.perspective=Ze?"":`${Pe}px`,P.current&&O.current&&(P.current.style.transform=`${Nt}${$t}translate(${Q}px,${Ke}px)`,O.current.style.transform=lr(ee,1/((u||10)/400)))}else{const Q=u===void 0?1:sr(H.current,R)*u;I.style.transform=`translate3d(${F[0]}px,${F[1]}px,0) scale(${Q})`}M.current=F,b.current=R.zoom}}if(!G&&k.current&&!W.current)if(o){if(P.current){const F=P.current.children[0];if(F!=null&&F.clientWidth&&F!=null&&F.clientHeight){const{isOrthographicCamera:J}=R;if(J||p)_.scale&&(Array.isArray(_.scale)?_.scale instanceof Y?k.current.scale.copy(_.scale.clone().divideScalar(1)):k.current.scale.set(1/_.scale[0],1/_.scale[1],1/_.scale[2]):k.current.scale.setScalar(1/_.scale));else{const K=(u||10)/400,le=F.clientWidth*K,me=F.clientHeight*K;k.current.scale.set(le,me,1)}W.current=!0}}}else{const F=I.children[0];if(F!=null&&F.clientWidth&&F!=null&&F.clientHeight){const J=1/q.factor,K=F.clientWidth*J,le=F.clientHeight*J;k.current.scale.set(K,le,1),W.current=!0}k.current.lookAt(U.camera.position)}});const Ye=g.useMemo(()=>({vertexShader:o?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[o]);return g.createElement("group",_e({},_,{ref:H}),n&&!G&&g.createElement("mesh",{castShadow:v,receiveShadow:h,ref:k},p||g.createElement("planeGeometry",null),w||g.createElement("shaderMaterial",{side:sn,vertexShader:Ye.vertexShader,fragmentShader:Ye.fragmentShader})))});let de=0;const Ar=wn(e=>(he.onStart=(t,r,i)=>{e({active:!0,item:t,loaded:r,total:i,progress:(r-de)/(i-de)*100})},he.onLoad=()=>{e({active:!1})},he.onError=t=>e(r=>({errors:[...r.errors,t]})),he.onProgress=(t,r,i)=>{r===i&&(de=i),e({active:!0,item:t,loaded:r,total:i,progress:(r-de)/(i-de)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),ze=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function At(e,t){const r=$(l=>l.gl),i=Z(Ge,ze(e)?Object.values(e):e);return g.useLayoutEffect(()=>{t==null||t(i)},[t]),g.useEffect(()=>{if("initTexture"in r){let l=[];Array.isArray(i)?l=i:i instanceof Ie?l=[i]:ze(i)&&(l=Object.values(i)),l.forEach(m=>{m instanceof Ie&&r.initTexture(m)})}},[r,i]),g.useMemo(()=>{if(ze(e)){const l={};let m=0;for(const f in e)l[f]=i[m++];return l}else return i},[e,i])}At.preload=e=>Z.preload(Ge,e);At.clear=e=>Z.clear(Ge,e);let we=null,Dt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function zt(e=!0,t=!0,r){return i=>{r&&r(i),e&&(we||(we=new bn),we.setDecoderPath(typeof e=="string"?e:Dt),i.setDRACOLoader(we)),t&&i.setMeshoptDecoder(typeof Me=="function"?Me():Me)}}const Xe=(e,t,r,i)=>Z(Ue,e,zt(t,r,i));Xe.preload=(e,t,r,i)=>Z.preload(Ue,e,zt(t,r,i));Xe.clear=e=>Z.clear(Ue,e);Xe.setDecoderPath=e=>{Dt=e};function fr(e,t,r){const i=$(s=>s.size),c=$(s=>s.viewport),l=typeof e=="number"?e:i.width*c.dpr,m=i.height*c.dpr,f=(typeof e=="number"?r:e)||{},{samples:u=0,depth:d,...o}=f,n=g.useMemo(()=>{const s=new an(l,m,{minFilter:Qe,magFilter:Qe,type:cn,...o});return d&&(s.depthTexture=new ln(l,m,un)),s.samples=u,s},[]);return g.useLayoutEffect(()=>{n.setSize(l,m),u&&(n.samples=u)},[u,n,l,m]),g.useEffect(()=>()=>n.dispose(),[]),n}const dr=e=>typeof e=="function",Dr=g.forwardRef(({envMap:e,resolution:t=256,frames:r=1/0,makeDefault:i,children:c,...l},m)=>{const f=$(({set:p})=>p),u=$(({camera:p})=>p),d=$(({size:p})=>p),o=g.useRef(null);g.useImperativeHandle(m,()=>o.current,[]);const n=g.useRef(null),s=fr(t);g.useLayoutEffect(()=>{l.manual||(o.current.aspect=d.width/d.height)},[d,l]),g.useLayoutEffect(()=>{o.current.updateProjectionMatrix()});let v=0,h=null;const w=dr(c);return Se(p=>{w&&(r===1/0||v<r)&&(n.current.visible=!1,p.gl.setRenderTarget(s),h=p.scene.background,e&&(p.scene.background=e),p.gl.render(p.scene,o.current),p.scene.background=h,p.gl.setRenderTarget(null),n.current.visible=!0,v++)}),g.useLayoutEffect(()=>{if(i){const p=u;return f(()=>({camera:o.current})),()=>f(()=>({camera:p}))}},[o,i,f]),g.createElement(g.Fragment,null,g.createElement("perspectiveCamera",_e({ref:o},l),!w&&c),g.createElement("group",{ref:n},w&&c(s.texture)))}),zr=g.forwardRef(({makeDefault:e,camera:t,regress:r,domElement:i,enableDamping:c=!0,keyEvents:l=!1,onChange:m,onStart:f,onEnd:u,...d},o)=>{const n=$(_=>_.invalidate),s=$(_=>_.camera),v=$(_=>_.gl),h=$(_=>_.events),w=$(_=>_.setEvents),p=$(_=>_.set),a=$(_=>_.get),y=$(_=>_.performance),S=t||s,x=i||h.connected||v.domElement,C=g.useMemo(()=>new En(S),[S]);return Se(()=>{C.enabled&&C.update()},-1),g.useEffect(()=>(l&&C.connect(l===!0?x:l),C.connect(x),()=>void C.dispose()),[l,x,r,C,n]),g.useEffect(()=>{const _=R=>{n(),r&&y.regress(),m&&m(R)},T=R=>{f&&f(R)},j=R=>{u&&u(R)};return C.addEventListener("change",_),C.addEventListener("start",T),C.addEventListener("end",j),()=>{C.removeEventListener("start",T),C.removeEventListener("end",j),C.removeEventListener("change",_)}},[m,f,u,C,n,w]),g.useEffect(()=>{if(e){const _=a().controls;return p({controls:C}),()=>p({controls:_})}},[e,C]),g.createElement("primitive",_e({ref:o,object:C,enableDamping:c},d))}),pr="modulepreload",vr=function(e){return"/"+e},dt={},mr=function(t,r,i){let c=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),f=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));c=Promise.allSettled(r.map(u=>{if(u=vr(u),u in dt)return;dt[u]=!0;const d=u.endsWith(".css"),o=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${o}`))return;const n=document.createElement("link");if(n.rel=d?"stylesheet":pr,d||(n.as="script"),n.crossOrigin="",n.href=u,f&&n.setAttribute("nonce",f),document.head.appendChild(n),d)return new Promise((s,v)=>{n.addEventListener("load",s),n.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(m){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=m,window.dispatchEvent(f),!f.defaultPrevented)throw m}return c.then(m=>{for(const f of m||[])f.status==="rejected"&&l(f.reason);return t().catch(l)})};var pt,vt;const hr=typeof window<"u"&&typeof((pt=window.document)==null?void 0:pt.createElement)=="function"&&typeof((vt=window.navigator)==null?void 0:vt.userAgent)=="string";let Fe=null;async function gr(...e){var t;(t=Fe)!==null&&t!==void 0||(Fe=await mr(()=>import("./hls.js-EjzhJXie.js"),[]));const r=Fe.default;return r.isSupported()?new r(...e):null}function Fr(e,{unsuspend:t="loadedmetadata",start:r=!0,hls:i={},crossOrigin:c="anonymous",muted:l=!0,loop:m=!0,playsInline:f=!0,...u}={}){const d=$(s=>s.gl),o=g.useRef(null),n=ht(()=>new Promise(async s=>{let v,h;typeof e=="string"?v=e:h=e;const w=Object.assign(document.createElement("video"),{src:v,srcObject:h,crossOrigin:c,loop:m,muted:l,playsInline:f,...u});if(v&&hr&&v.endsWith(".m3u8")){const a=o.current=await gr(i);a&&(a.on(Pn.MEDIA_ATTACHED,()=>void a.loadSource(v)),a.attachMedia(w))}const p=new fn(w);"colorSpace"in p?p.colorSpace=d.outputColorSpace:p.encoding=d.outputEncoding,w.addEventListener(t,()=>s(p))}),[e]);return g.useEffect(()=>(r&&n.image.play(),()=>{o.current&&(o.current.destroy(),o.current=null)}),[n,r]),n}const Ir=g.forwardRef(function({children:t,disable:r,disableX:i,disableY:c,disableZ:l,left:m,right:f,top:u,bottom:d,front:o,back:n,onCentered:s,precise:v=!0,cacheKey:h=0,...w},p){const a=g.useRef(null),y=g.useRef(null),S=g.useRef(null);return g.useLayoutEffect(()=>{y.current.matrixWorld.identity();const x=new dn().setFromObject(S.current,v),C=new Y,_=new pn,T=x.max.x-x.min.x,j=x.max.y-x.min.y,R=x.max.z-x.min.z;x.getCenter(C),x.getBoundingSphere(_);const L=u?j/2:d?-j/2:0,E=m?-T/2:f?T/2:0,A=o?R/2:n?-R/2:0;y.current.position.set(r||i?0:-C.x+E,r||c?0:-C.y+L,r||l?0:-C.z+A),typeof s<"u"&&s({parent:a.current.parent,container:a.current,width:T,height:j,depth:R,boundingBox:x,boundingSphere:_,center:C,verticalAlignment:L,horizontalAlignment:E,depthAlignment:A})},[h,s,u,m,o,r,i,c,l,v,f,d,n]),g.useImperativeHandle(p,()=>a.current,[]),g.createElement("group",_e({ref:a},w),g.createElement("group",{ref:y},g.createElement("group",{ref:S},t)))}),Hr=g.forwardRef(({children:e,enabled:t=!0,speed:r=1,rotationIntensity:i=1,floatIntensity:c=1,floatingRange:l=[-.1,.1],autoInvalidate:m=!1,...f},u)=>{const d=g.useRef(null);g.useImperativeHandle(u,()=>d.current,[]);const o=g.useRef(Math.random()*1e4);return Se(n=>{var s,v;if(!t||r===0)return;m&&n.invalidate();const h=o.current+n.clock.getElapsedTime();d.current.rotation.x=Math.cos(h/4*r)/8*i,d.current.rotation.y=Math.sin(h/4*r)/8*i,d.current.rotation.z=Math.sin(h/4*r)/20*i;let w=Math.sin(h/4*r)/10;w=vn.mapLinear(w,-.1,.1,(s=l==null?void 0:l[0])!==null&&s!==void 0?s:-.1,(v=l==null?void 0:l[1])!==null&&v!==void 0?v:.1),d.current.position.y=w*c,d.current.updateMatrix()}),g.createElement("group",f,g.createElement("group",{ref:d,matrixAutoUpdate:!1},e))});export{Ir as C,Hr as F,kr as H,zr as O,Dr as P,Xe as a,At as b,Tr as c,Se as d,Lr as e,Fr as f,jr as g,Ar as u};
